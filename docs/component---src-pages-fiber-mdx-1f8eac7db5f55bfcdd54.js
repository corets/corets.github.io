(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"7sYw":function(e,t,n){"use strict";n.r(t),n.d(t,"_frontmatter",(function(){return o})),n.d(t,"default",(function(){return s}));var r=n("Fcif"),a=n("+I+c"),i=(n("mXGw"),n("/FXl")),c=n("BIGe"),o=(n("aD51"),{});void 0!==o&&o&&o===Object(o)&&Object.isExtensible(o)&&!o.hasOwnProperty("__filemeta")&&Object.defineProperty(o,"__filemeta",{configurable:!0,value:{name:"_frontmatter",filename:"src/pages/fiber.mdx"}});var b={_frontmatter:o},l=c.a;function s(e){var t=e.components,n=Object(a.a)(e,["components"]);return Object(i.b)(l,Object(r.a)({},b,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("h1",{id:"fiber"},"Fiber"),Object(i.b)("p",null,"Statically typed client for remote, RPC style communication. Consume your backend API through a statically typed facade, without any code generation, without writing any custom API calls or duplicating your backend types on the client side. Fibers work in any TypeScript setup and are fully implementation agnostic."),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Full static typing from tail to toe"),Object(i.b)("li",{parentName:"ul"},"Implementation agnostic"),Object(i.b)("li",{parentName:"ul"},"Works for client to server or server to server communication"),Object(i.b)("li",{parentName:"ul"},"Build an SDK for your backend in minutes"),Object(i.b)("li",{parentName:"ul"},"No code generation")),Object(i.b)("pre",null,Object(i.b)("code",Object(r.a)({parentName:"pre"},{className:"language-bash"}),"yarn add @corets/fiber\n")),Object(i.b)("h2",{id:"quick-start"},"Quick start"),Object(i.b)("p",null,"First you need to create a fiber and register all the methods that you want to expose accordingly:"),Object(i.b)("pre",null,Object(i.b)("code",Object(r.a)({parentName:"pre"},{className:"language-ts"}),'import { createFiber } from "@corets/fiber"\n\nconst makeResponse = (status: number, result: any) => {\n  return { status, result }\n}\n\nconst pingPong = (input: string) => {\n  return makeResponse(200, input === "ping" ? "pong" : "ping")\n}\n\nexport const fiber = createFiber({ pingPong })\nexport type MyFiber = typeof fiber\n')),Object(i.b)("p",null,"Next you need to setup your server, we'll be using express in this example:"),Object(i.b)("pre",null,Object(i.b)("code",Object(r.a)({parentName:"pre"},{className:"language-tsx"}),'import express from "express"\nimport { fiber } from "./fiber"\n\nconst app = express()\n\napp.post("/fiber/:method", async (req, res) => {\n  try {\n    const method = req.params?.method\n    const args = Object.values(req?.body)\n    const response = await fiber.call(method, ...args)\n\n    res.status(response.status).json(response.result)\n  } catch (err) {\n    console.error(err)\n    res.status(500).send()\n  }\n})\n\napp.listen(1337)\n')),Object(i.b)("p",null,"Next you create a consumer for your fiber, on the client side, we'll use axios in this example:"),Object(i.b)("pre",null,Object(i.b)("code",Object(r.a)({parentName:"pre"},{className:"language-ts"}),'import { createFiberClient } from "@corets/fiber"\nimport axios from "axios"\nimport type { MyFiber } from "./fiber"\n\nexport const client = createFiberClient<MyFiber>(async (method, ...args) => {\n  const res = await axios.post(`http://localhost:1337/fiber/${method}`, args)\n\n  return res.data\n})\n')),Object(i.b)("p",null,"Now you have a statically typed, RPC style client, that you can consume immediately on the client side (web, node, mobile):"),Object(i.b)("pre",null,Object(i.b)("code",Object(r.a)({parentName:"pre"},{className:"language-ts"}),'import { client } from "./client"\n\n// returns pong\nconst answer = await client.pingPong("ping")\n')),Object(i.b)("h2",{id:"createfiber"},Object(i.b)("inlineCode",{parentName:"h2"},"createFiber")),Object(i.b)("p",null,"Create a new fiber instance on the producer side:"),Object(i.b)("pre",null,Object(i.b)("code",Object(r.a)({parentName:"pre"},{className:"language-ts"}),'import { createFiber } from "@corets/fiber"\n\nconst myMethod = () => "hallo"\n\nconst fiber = createFiber({ myMethod })\n')),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Note:")," Returns an instance of ",Object(i.b)("a",Object(r.a)({parentName:"p"},{href:"#simplefiber"}),"SimpleFiber"),"."),Object(i.b)("h2",{id:"createfiberclient"},Object(i.b)("inlineCode",{parentName:"h2"},"createFiberClient")),Object(i.b)("p",null,"Create a statically typed fiber client:"),Object(i.b)("pre",null,Object(i.b)("code",Object(r.a)({parentName:"pre"},{className:"language-ts"}),'import { createFiberClient } from "@corets/fiber"\nimport type { fiber } from "./fiber"\n\nconst client = createFiberClient<typeof fiber>((method, ...args) => {\n  // proxy request to producer\n})\n')),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Note:")," Returns an instance of ",Object(i.b)("a",Object(r.a)({parentName:"p"},{href:"#simplefiberclient"}),"SimpleFiberClient"),"."),Object(i.b)("h2",{id:"simplefiber"},Object(i.b)("inlineCode",{parentName:"h2"},"SimpleFiber")),Object(i.b)("p",null,"Statically typed facade that is used to bootstrap a fiber instance on the producer side."),Object(i.b)("h2",{id:"simplefibercall"},Object(i.b)("inlineCode",{parentName:"h2"},"SimpleFiber.call")),Object(i.b)("p",null,"Call a registered fiber method on the producer side:"),Object(i.b)("pre",null,Object(i.b)("code",Object(r.a)({parentName:"pre"},{className:"language-ts"}),'import { createFiber } from "@corets/fiber"\n\nconst fiber = createFiber({\n  greet (name: string) {\n    return `Hallo ${name}!`\n  }\n})\n\n// method names and parameters are fully statically typed\nconst greeting = await fiber.call("greet", "John")\n')),Object(i.b)("h2",{id:"simplefiberclient"},Object(i.b)("inlineCode",{parentName:"h2"},"SimpleFiberClient")),Object(i.b)("p",null,"Statically typed client for a fiber, used on the consumer side."),Object(i.b)("h2",{id:"simplefiberclientcall"},Object(i.b)("inlineCode",{parentName:"h2"},"SimpleFiberClient.call")),Object(i.b)("pre",null,Object(i.b)("code",Object(r.a)({parentName:"pre"},{className:"language-ts"}),'import { createFiberClient } from "@corets/fiber"\nimport type { MyFiber } from "./fiber"\n\nconst client = createFiberClient<MyFiber>((method, ...args) => {\n  // bridge implementation\n})\n\n// method names and parameters are fully statically typed\nconst response = await client.call("greeting", "John")\n// or\nconst response = await client.greeting("John")\n')))}void 0!==s&&s&&s===Object(s)&&Object.isExtensible(s)&&!s.hasOwnProperty("__filemeta")&&Object.defineProperty(s,"__filemeta",{configurable:!0,value:{name:"MDXContent",filename:"src/pages/fiber.mdx"}}),s.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-fiber-mdx-1f8eac7db5f55bfcdd54.js.map